## 业务提示

商铺中分两种角色，一种是创始人founder，一种是管理员。创始人是商铺创建者，可以邀请其他用户作为管理员，也可以删除、转交商铺，不可退出商铺，需先转交商铺才可退出，拥有最大权限。而管理员可以上架、下架、调整商品信息等，也可以修改商铺信息，可直接退出商铺

再次声明，uri前缀是`/store`



##接口行为

1. 创建/删除/查看/修改指定用户商铺
2. 商铺邀请/剔除/退出/查看/转交商铺创始人
3. 用户查看/关注/取关商铺



##1. 

###创建商铺

需求解剖

* 需要上传商铺logo，那么需要令起一个接口作为用户上传图片的路径，以此实现异步

  接口与需求文档：需要用户上传成功并接收到logo的url后，实时展示到界面上并弹出上传成功

  uri：`/store/logo`，POST请求，请求头记得携带token（后续将不提示，默认都待请求头token）

  请求body：文件资源，考虑只先只接收jpg、png、jpeg这三后缀图片

  响应body：

  ```json
  {
      code: 200,
      msg: "操作成功",
      logoUrl: "https://..."
  }
  ```

* 填写商铺信息，如名字、描述。现不考虑商铺申请的限制，即一个用户可以创建多个商铺且暂无后台管理人员管理商铺创建

  接口与需求文档：必须得填商铺名字，商铺名字会存在唯一的冲突，logo的url是刚刚用户上传的图片，在展示给用户后记得留存下来，商铺描述可不填

  uri：`/store/add`，POST请求，请求头记得携带token

  请求体：

  ```json
  {
    name: "无敌商铺",
    logoUrl: "https://...",
    description: "可不填，非必须",
  }
  ```

  响应体（**后续不写将代表就是以下的响应了**）：

  ```json
  {
    code: 200,
    msg: "操作成功" // 成功默认都有的，以后我没写也加上
  }
  ```

  ​



### 删除商铺

接口与需求文档：提交请求前应该先提示是否要删除商铺，删除操作传递商铺的id，后台会校验用户是否有删除该商铺功能，并删除其他关联的用户，比如关注者和管理者

uri：`/store/del?storeId=186af4sdfasd8f`，DELETE请求，请求头记得携带token

请求体：无（**以后不写就是无**）



### 查看包含自己的商铺

接口与需求文档：查看指定用户的商铺，后面的self表示是否查看为当前用户创建的商铺，1表示查看自己的商铺，0表示查看所有属于自己的商铺，包括管理员。考虑采取分页操作，分页会返回总共的数量和pageSize个商铺

uri：`/store/list?self=1`，GET请求，请求头记得携带token，token中会有用户信息，不必要传用户id

请求体（以下是默认值）：

```json
{
  pageNum: 0
  pageSize: 10,
}
```



响应体：

```json
{
  code: 200,
  msg: "操作成功",
  stores: {
      rows: [
        {
          id: "商铺id",
          name: "商铺名字",
          logoUrl: "商铺logo地址",
          followCount: 100， // 店铺的关注数
          score: 4.515648551204, // 店铺评分
          createTime: 2024-6-6 06:06:06,
          founderId: 1984159741894 // 创始人id，这个创始人在创建后是不会再变了
          founder: "创始人名字"
        },
        {},{}, ...
     ],
     total: 20
  }
}
```



### 修改商铺

接口与需求文档：修改商铺logo采用创建的那个接口，同样也是实时的更新到浏览器中，但会在点击确认修改后才正常请求到后端修改数据

uri：`/store/update`，PUT请求，请求头记得携带token

请求体：

```json
{
  id: "店铺id" // 这个可不能被用户改
  name: "无敌商铺",
  logoUrl: "https://...",
  description: "可不填，非必须",
}
```





##2.

### 查看商铺人员

接口与需求文档：查看的人员包括有创始人和后续邀请加入的管理员，要注意打上创始人的标签。创始人只有一个，但管理员可有多个。注意，这个只有处于当前商铺的管理员才能执行，后台会控制。注意，这里将不分页，因为店铺管理员一般不会超过千个，在千个以内想必前端能抗住，界面考虑使用自动折叠来避免界面混乱

uri：`/store/user/list?storeId=xxxx`，GET请求，请求头记得携带token

响应体：

```json
{
  code: 200,
  msg: "操作成功",
  founder: "创始人名字",
  managers: [
      "管理员名字","",""
  ]
}
```



### 商铺邀请

接口与需求文档：提交请求前应该先提示是否要邀请，通过输入**用户名/邮箱/电话**来邀请，注意者三种分为三个属性来填写，可填多份，但不允许三份均为空。在响应时会将所有的用户名都返回给用户，表明这些用户已经添加成功，并实时更新到当前界面。如果用户不存在，后台会返回对应的错误信息，并会导致所有的操作都失败，所以添加失败**别直接刷新用户界面了**

uri：`/store/user/invite`，PUT请求，请求头记得携带token

请求体：

```json
{
  id: "商铺的id",
  userNames: [
      "用户名1","用户名"
  ],
  emails: [
      "",""
  ],
  phones: [
      "",""
  ]
}
```

响应体：

```json
{
  code: 200,
  msg: "操作成功",
  userNames: [
      "","","",...
  ]
}
```



###  剔除商铺管理员

接口与需求文档：这个只能商铺的创始人才能执行，首先会查询商铺中的所有人员，然后将管理员作为候选人员，点击名字删除。如果删除成功，将这些管理员名字删除出界面，否则若是存在异常将回滚删除操作，界面不会刷新并给出弹窗提示

url：`/store/user/del`，DELETE请求，token

请求体：

```json
{
  id: "店铺id",
  names: [
      "管理员1名字", "",...
  ]
}
```



### 退出商铺

接口与需求文档：管理员退出指定商铺

uri：`/store/user/exit?storeId=xxxx`，PUT请求，token





## 3.

### 查看商铺

接口与需求文档：第一个是批量查询，是系统管理员才有的操作，普通用户无法批量查询，可以考虑不做先

> 批量查

uri:`/store/list`，GET请求，token

请求体：

```json
{
  name: "商铺名字，支持模糊查询",
}
```

响应体：

```json
{
  code: 200,
  msg: "操作成功",
  stores: {
      rows: [
        {
          id: "商铺id",
          name: "商铺名字",
          logoUrl: "商铺logo地址",
          followCount: 100， // 店铺的关注数
          score: 4.515648551204, // 店铺评分
          createTime: 2024-6-6 06:06:06,
          founderId: 1984159741894 // 创始人id，这个创始人在创建后是不会再变了
          founder: "创始人名字"
        },
        {},{}, ...
     ],
     total: 20
  }
}
```



> id查

这个接口的应用场景是在用户浏览商品的时候点击店铺会执行，现在暂时没什么用，可以留到后续做

uri：`store/get?storeId=xxx`，GET请求，不需要token

响应体

```json
{
  id: "商铺id",
  name: "商铺名字",
  logoUrl: "商铺logo地址",
  followCount: 100， // 店铺的关注数
  score: 4.515648551204, // 店铺评分
  createTime: 2024-6-6 06:06:06,
  founderId: 1984159741894 // 创始人id，这个创始人在创建后是不会再变了
  founder: "创始人名字"
}
```



### 关注商铺

接口与需求文档：用户查询到商铺后，可以点击关注商铺

uri：`/store/follow?storeId`，POST请求，token



### 取关商铺

uri：`/store/unfollowing?storeId`，POST请求，token